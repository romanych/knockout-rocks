<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <script type="text/javascript" src="knockout-latest.js"></script>
    <script type="text/javascript" src="jquery-1.5.2.min.js"></script>

</head>
<body>
<div>
    <h1>Knockout</h1>
   <script type="text/html" id="circleTemplate">
       <svg>
           <circle
                   cx="105"
                   cy="105"
                   stroke-width="3"
                   fill="transparent"
                   data-bind="
                    attr: {
                        r: radius,
                        stroke: color,
                        },
                        style: {
                        'stroke-dasharray': strokeDashArray
                        },
                        click: randomizeColor
                    "
                   />
       </svg>
   </script>
    <div data-bind="foreach: Circles" style="overflow: hidden;">
        <div style="margin: 10px; float: left;">
            <h3 data-bind="text: name">Circle title</h3>
            <div style="background: #eee; height: 210px; width: 210px; float: left; margin-right: 20px;"
                 data-bind="template: 'circleTemplate'"></div>
            <a href="#edit" data-bind="click: $parent.EditCircle">Edit</a>
        </div>
    </div>
    <div data-bind="with: EditingCircle">
        <h3 data-bind="text: name">Circle title</h3>
        <div style="background: #eee; height: 210px; width: 210px; float: left; margin-right: 20px;"
             data-bind="template: 'circleTemplate'"></div>

        <div>
            Name:
            <input type="text" data-bind="value: name, valueUpdate: 'afterkeydown'"/><br/>
            Radius:
            <input type="range" min="10" max="100" step="1" data-bind="value: radius"/><br/>
            Color:
            <input type="text" data-bind="value: color"/><br/>
            <br/>
            Radius: <label data-bind="text: radius() + 'px'"></label>
            <br/>
            <label>
                <input type="checkbox" data-bind="checked: enableDashes"/>
                Dashed
            </label>
            <select data-bind="
                value: strokeDash,
                enable: enableDashes,
                options: strokeDashes"></select><br />
            <input type="button" data-bind="click: $parent.EndEditing" value="Done"/>
        </div>
    </div>
</div>
<script type="text/javascript">
    function random_color() {
        var rint = Math.round(0xffffff * Math.random());
        return ('#0' + rint.toString(16)).replace(/^#0([0-9a-f]{6})$/i, '#$1');
    }

    var CircleViewModel = function (name) {
        var self = this;

        self.name = ko.observable(name);
        self.radius = ko.observable(50);
        self.color = ko.observable('red');
        self.enableDashes = ko.observable();
        self.strokeDash = ko.observable(5);
        self.strokeDashes = [4, 8, 16, 32];

        self.strokeDashArray = ko.computed(function () {
            return self.enableDashes() ? self.strokeDash() : undefined;
        })

        self.randomizeColor = function () {
            self.color(random_color());
        }
    };

    var MainViewModel = function () {
        var self = this;

        self.Circles = ko.observableArray();
        for (var i = 1; i <= 4; i++) {
            self.Circles.push(new CircleViewModel('Circle ' + i));
        }

        self.EditingCircle = ko.observable();
        self.EditCircle = function(circle) {
            self.EditingCircle(circle);
        };
        self.EndEditing = function() {
            self.EditingCircle(undefined);
        }
    }

    ko.applyBindings(new MainViewModel());
</script>
</body>
</html>